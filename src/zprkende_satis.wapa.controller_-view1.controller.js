sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/m/MessageToast","sap/m/MessageBox","test/model/formatter"],function(e,t,r,s,o,a){"use strict";var i;var n;var l;var u=[];var d;var g;var +
c=1;var h=[];let m=[];var p=[];return e.extend("test.controller.View1",{onInit:function(){this._oCurrentRequest=null;const e=new r({bundleName:"test.i18n.i18n"});this.getView().setModel(e,"i18n");var s=sap.ui.core.UIComponent.getRouterFor(this);s.getRout+
e("RouteView1").attachMatched(this._onRouteMatched,this);var o=new t;var a=new t;this.getView().setModel(o,"SelectedItems");this.getView().setModel(a,"BagliItems");this.oView=this.getView();this.oButton=this.byId("BadgedButton");this.getOwnerComponent().+
getModel("AddBasket").setProperty("/sepet",{sepet:h});var n=this.getView().byId("treeTable");n.setVisibleRowCount(16);this.getView().setBusy(true);this.getOwnerComponent().getModel().read("/treeSet",{success:function(e,r){this.getView().setBusy(true);var+
 s=e.results;m.push(s);i=e.results;var o=[];var a=[];var n=[];var l=[];var u=[];var d=[];var g=[];var c=[];var h=[];var v=[];var f=[];var P=[];for(var I=0;I<s.length;I++){switch(s[I].HLevel){case 0:u={Description:s[I].Aciklama,Drillstate:s[I].Status,Hier+
archyLevel:s[I].HLevel,NodeID:s[I].NodeId,ParentNodeID:s[I].PnodeId,remItems:s[I],children:h};o.push({oListItem0:u});break;case 1:d={Description:s[I].Aciklama,Drillstate:s[I].Status,HierarchyLevel:s[I].HLevel,NodeID:s[I].NodeId,ParentNodeID:s[I].PnodeId,+
remItems:s[I],children:v};a.push({oListItem1:d});break;case 2:g={Description:s[I].Aciklama,Drillstate:s[I].Status,HierarchyLevel:s[I].HLevel,NodeID:s[I].NodeId,ParentNodeID:s[I].PnodeId,remItems:s[I],children:f};n.push({oListItem2:g});break;case 3:c={Des+
cription:s[I].Aciklama,Drillstate:s[I].Status,HierarchyLevel:s[I].HLevel,NodeID:s[I].NodeId,ParentNodeID:s[I].PnodeId,remItems:s[I],children:P};l.push({oListItem3:c});break}}var y=[];var w=[];var B=[];var D=[];var V=[];var C=[];var L=[];for(var I=0;I<o.l+
ength;I++){B=[];for(var T=0;T<a.length;T++){if(o[I].oListItem0.NodeID===a[T].oListItem1.ParentNodeID){w=[];for(var S=0;S<n.length;S++){if(a[T].oListItem1.NodeID===n[S].oListItem2.ParentNodeID){y=[];for(var M=0;M<l.length;M++){if(n[S].oListItem2.NodeID===+
l[M].oListItem3.ParentNodeID){D={Description:l[M].oListItem3.Description,Drillstate:l[M].oListItem3.Drillstate,HierarchyLevel:l[M].oListItem3.HierarchyLevel,NodeID:l[M].oListItem3.NodeID,ParentNodeID:l[M].oListItem3.ParentNodeID,remItems:l[M].oListItem3}+
;y.push(D)}}V={Description:n[S].oListItem2.Description,Drillstate:n[S].oListItem2.Drillstate,HierarchyLevel:n[S].oListItem2.HierarchyLevel,NodeID:n[S].oListItem2.NodeID,ParentNodeID:n[S].oListItem2.ParentNodeID,remItems:n[S].oListItem2,children:y};w.push+
(V)}}C={Description:a[T].oListItem1.Description,Drillstate:a[T].oListItem1.Drillstate,HierarchyLevel:a[T].oListItem1.HierarchyLevel,NodeID:a[T].oListItem1.NodeID,ParentNodeID:a[T].oListItem1.ParentNodeID,remItems:a[T].oListItem1,children:w};B.push(C)}}L=+
{Description:o[I].oListItem0.Description,Drillstate:o[I].oListItem0.Drillstate,HierarchyLevel:o[I].oListItem0.HierarchyLevel,NodeID:o[I].oListItem0.NodeID,ParentNodeID:o[I].oListItem0.ParentNodeID,remItems:o[I].oListItem0,children:B};p.push(L)}var b=new +
t;b.setData(p);this.getView().setModel(b,"oModel_tree");this.getView().getModel("oModel_tree").refresh();this.getView().setBusy(false)}.bind(this)})},_onRouteMatched:function(e){var t,t=e.getParameter("arguments");var r=t.param;if(r){var s=this.getView()+
.getModel("AddBasket").getProperty("/sepet/sepet").length;if(s>0){this.oButton.getBadgeCustomData().setValue(s)}else{this.oButton.getBadgeCustomData().setValue("")}}},formatCurrency:function(e){return a.formatCurrency(e)},onSearchProduct:function(e){var +
t=e.getParameter("query");if(t.length>3){var r=encodeURIComponent(t);var s=true;this.getView().setBusy(true);this.getOwnerComponent().getModel().read("/refTreeSet(Ref='"+r+"',Search='"+s+"')/tree_to_urunler",{success:function(e){this.getView().setBusy(tr+
ue);var t=e.results;d=t;this.getOwnerComponent().getModel("TreeProductSet").setProperty("/tree",{tree:d});this.getView().setBusy(false)}.bind(this),error:function(e){o.error("Error occurred: "+e.responseText);this.getView().setBusy(false)}})}this.getView+
().setBusy(false)},liveChangeProduct:function(){var e=this.getView().byId("searchField").getValue();if(e.length>2){var t=encodeURIComponent(e);var r=true;if(this._oCurrentRequest){this._oCurrentRequest.abort()}this.getView().setBusy(true);this._oCurrentR+
equest=this.getOwnerComponent().getModel().read("/refTreeSet(Ref='"+t+"',Search='"+r+"')/tree_to_urunler",{success:function(e){this.getView().setBusy(true);var t=e.results;d=t;this.getOwnerComponent().getModel("TreeProductSet").setProperty("/tree",{tree:+
d});this.getView().setBusy(false)}.bind(this),error:function(e){this.getView().setBusy(false)}.bind(this)})}else{if(this._oCurrentRequest){this._oCurrentRequest.abort()}this.getView().setBusy(false)}},addToBasket:function(e){this.getView().setBusy(true);+
var t=e.getSource();t.setEnabled(false);let r=e.getSource().getParent().getParent().getBindingContext("BagliProductSet").getObject();var s=this.getOwnerComponent().getModel("AddBasket");let o=s.getProperty("/sepet/sepet");const a=this.getView().getModel(+
"i18n").getResourceBundle();var i;if(r){if(r.count===1){r.toplamKDV=r.Kdv;r.tutar=r.Tutar;r.tutar=r.Tutar2;r.tutar=r.BirimToplamTutar;r.toplamKDVsizFiyat=r.Price;r.id=Math.floor(Math.random()*1e14)}else{r.id=Math.floor(Math.random()*1e14)}}o.push(r);s.se+
tProperty("/basket",o);s.setProperty("/sepet/sepet",o);g=s.getProperty("/basket").length;this.getOwnerComponent().getModel("AddBasket").setProperty("/sepetLength",g);this.getView().setBusy(false);setTimeout(function(){t.setEnabled(true)},1300);if(g>0){th+
is.oButton.getBadgeCustomData().setValue(g);i=a.getText("addingSuccess");this.getView().byId("searchField").setValue("");sap.m.MessageToast.show(i);this.onCloseButtonPress()}else{i=a.getText("selectProduct");sap.m.MessageToast.show(i)}this.getView().setB+
usy(false)},onColumnListItemPress:function(e){var t=this.getView().byId("idProductCollectionTable");var r=this.getView().byId("treeTable");var s=this.getView().byId("idPage");var a=s.getEventingParent()._mFocusObject;var i=this.getOwnerComponent().getMod+
el();n=e.oSource.mAggregations.cells[1].mProperties.text;var l=/\(([^)]+)\)/;var d=n.match(l);var g=d?d[1]:null;this.getView().setBusy(true);i.read("/HeaderBagliUrunlerSet('"+g+"')/HeaderToItemNav",{success:function(e,t){u=e.results;u.forEach(function(e)+
{e.tutar=e.Tutar;e.Tutar2=e.Tutar;e.BirimToplamTutar=e.Tutar;e.count=1});this.getOwnerComponent().getModel("BagliProductSet").setProperty("/",{bagli:u});this.fragmentLaden();this.getView().setBusy(false)}.bind(this),error:function(e){o.error("Error occur+
red: "+e.responseText);this.getView().setBusy(false)}.bind(this)})},fragmentLaden:async function(){this.oDialog??=await this.loadFragment({name:"test.fragments.product"});var e=this.getView().getModel("BagliProductSet");this.oDialog.setModel(e,"BagliProd+
uctSet");this.oDialog.bindElement({path:"/"});this.getView().byId("CurrentValue").setValue("");this.oDialog.open()},onCloseButtonPress:function(){this.getView().byId("tab1").removeSelections();this.oDialog.close()},onClearBasket:function(){const e=this.g+
etView().getModel("i18n").getResourceBundle();var t=e.getText("messageText2");var r=this.getOwnerComponent().getModel("AddBasket");r.setProperty("/sepet/sepet",[]);r.setProperty("/customerInfo",{});r.setProperty("/salesmanInfo",{});r.setProperty("/inputs+
Visible",false);r.setProperty("/step0",false);r.setProperty("/step1",false);r.setProperty("/step2",false);r.setProperty("/step3",false);r.setProperty("/updateEnable",false);r.setProperty("/createEnable",false);this.oButton.getBadgeCustomData().setValue("+
");s.show(t);setTimeout(()=>{this.getOwnerComponent().getRouter().navTo("RouteView0")},1e3)},onGoView0:function(){this.onClearBasket();this.oButton.getBadgeCustomData().setValue("");this.getOwnerComponent().getRouter().navTo("RouteView0")},onBadgedButton+
Press:function(){let e=this.getView().getModel("AddBasket").getProperty("/sepet/sepet");var t=e.length;var r=e.map(e=>({...e}));if(r){var s=r.reduce((e,t)=>(parseFloat(e)+parseFloat(t.tutar)).toString(),"0");var o=r.reduce((e,t)=>(parseFloat(e)+parseFloa+
t(t.toplamKDVsizFiyat)).toString(),"0");var a=r.reduce((e,t)=>(parseFloat(e)+parseFloat(t.toplamKDV)).toString(),"0");this.getOwnerComponent().getModel("AddBasket").setProperty("/ProductsTotalPrice",s);this.getOwnerComponent().getModel("AddBasket").setPr+
operty("/TotalPriceWithoutVAT",o);this.getOwnerComponent().getModel("AddBasket").setProperty("/ProductsTotalVAT",a);this.getOwnerComponent().getModel("AddBasket").setProperty("/ProductsArtNumber",t)}else{oModelSepet.setProperty("/ProductsTotalPrice",0)}i+
f(e.length>0){setTimeout(()=>{this.getOwnerComponent().getRouter().navTo("RouteView4",{param:"test"})},200)}},toggleOpenState:function(e){},onRowSelectionChange:function(e){var t=e.getParameters().rowBindingContext.sPath;var r=this.getView().byId("treeTa+
blePage");var s=t.split("/");if(s.length>3){var a=[];for(var n=0;n<s.length;n++){if(s[n]!="children"&&s[n]!=""){a.push(s[n])}}if(e.getParameters().rowBindingContext.oModel.oData[a[0]]){var l=e.getParameters().rowBindingContext.oModel.oData[a[0]].children+
[a[1]].children[a[2]].children[a[3]].Description}if(l!==undefined){var u=[];for(var n=0;n<i.length;n++){if(i[n].Aciklama===l){u.push(i[n])}}var g=false;var c=u[0].RefTree;this.getView().setBusy(true);this.getOwnerComponent().getModel().read("/refTreeSet(+
Ref='"+c+"',Search='"+g+"')/tree_to_urunler",{success:function(e){var t=e.results;d=t;this.getOwnerComponent().getModel("TreeProductSet").setProperty("/tree",{tree:d});this.getView().setBusy(false)}.bind(this),error:function(e){o.error("Error occurred: "+
+e.responseText);this.getView().setBusy(false)}})}}},onScanSuccess:function(e){if(e.getParameter("cancelled")){s.show("Scan cancelled",{duration:1e3})}else{if(e.getParameter("text")){var t=e.getParameter("text");this.getOwnerComponent().getModel().read("+
/BarkodUrunSet('"+t+"')",{success:function(e){u=Array.isArray(e)?e:[e];u.forEach(function(e){e.tutar=e.Tutar;e.Tutar2=e.Tutar;e.BirimToplamTutar=e.Tutar;e.count=1});this.getOwnerComponent().getModel("BagliProductSet").setProperty("/",{bagli:u});this.frag+
mentLaden()}.bind(this),error:function(e){o.error("Error occurred: "+e.responseText)}})}else{l.setText("");this.getView().setBusy(false)}}},onScanError:function(e){s.show("Scan failed: "+e,{duration:1e3});this.getView().setBusy(false)},onScanLiveupdate:f+
unction(e){},currentChangeHandler:function(e){c=e.mParameters.value;var t=this.getView().getModel("BagliProductSet");var r=t.getProperty(e.getSource().getBindingContext("BagliProductSet").getPath()+"/Tutar");var s=e.getSource().getBindingContext("BagliPr+
oductSet").getPath();var o=c*parseFloat(r);var a=o.toFixed(3);var i=t.getProperty(e.getSource().getBindingContext("BagliProductSet").getPath()+"/Kdv");var n=c*parseFloat(i);var l=n.toFixed(3);var u=t.getProperty(e.getSource().getBindingContext("BagliProd+
uctSet").getPath()+"/Price");var d=c*parseFloat(u);var g=d.toFixed(3);t.setProperty(s+"/tutar",a);t.setProperty(s+"/Tutar2",a);t.setProperty(s+"/BirimToplamTutar",a);t.setProperty(s+"/toplamKDV",l);t.setProperty(s+"/toplamKDVsizFiyat",g);t.setProperty(s++
"/count",c)}})});                                                                                                                                                                                                                                              
//# sourceMappingURL=View1.controller.js.map                                                                                                                                                                                                                   